# 数据库

ShipAny 使用 drizzle-orm 支持多种类型数据库。

## 配置数据库

以 Supabase 数据库为例，在 ShipAny 配置数据库的流程为：

### 创建数据库
登录 Supabase 控制台，创建数据库

### 查看数据库连接信息
在 Supabase 控制台，进入你创建的数据库，点击上方的 Connect

在弹出来的框中复制数据库连接信息，类似这样的字符串：

需要替换成你在创建数据库时设置的密码。

### 配置数据库
修改项目配置文件： 和 
设置数据库连接信息：

### 初始化数据库
在配置好后，在项目根目录下运行以下命令，初始化数据库：

这个命令会执行目录下的所有迁移文件，创建数据库表。

如果你通过配置的不是一个新创建的数据库，或者数据库之前已经存在 ShipAny 的库表信息，请不要执行以上命令。而是比较目录下所有迁移文件的 sql 内容，手动执行 sql 语句，更新数据库表。

### 更新数据库
如果在项目创建之处，你使用的是一个新的数据库，且是通过命令初始化的数据库，如果后续你拉取了最新的代码，可以继续执行以下命令，更新数据库表：

这个命令会根据目录下所有迁移文件的 sql 内容，增量更新数据库表。

### 管理数据库
在项目根目录下执行命令：

这个命令会打开一个数据库管理界面，你可以在这里查看、编辑、删除数据库表。

### 操作数据库
在目录下，写数据库操作文件，实现对数据表的增删改查。可参考以下操作 posts 表的示例：

数据表操作语法可参考 drizzle-orm 文档。

## 使用其他类型数据库

如果你使用自建的 Postgres 数据库，或者使用其他兼容 postgres 的云数据库，比如：Neon。配置和连接数据库的步骤跟使用 Supabase 一致，你只需要填写数据库的即可。

如果你需要使用 MySQL 或者 SQLite 等数据库，可参考以下步骤自定义：

### 使用新的数据库 Schema
修改文件，使用新的数据库 Schema。
Schema 中数据表的字段定义，可以参考 drizzle-orm 文档。

### 修改数据库配置
修改文件，使用新的数据库连接配置。
默认是 Postgres 数据库连接配置，你可以参考 drizzle-orm 文档按需修改。

### 修改数据库连接实例
根据你使用的数据库类型，修改数据库连接实例。

### 生成数据库迁移文件
如果你希望后续通过迁移文件更新数据库表。你可以在完成以上三步之后，在项目根目录下执行以下命令生成数据库迁移文件。

在 ShipAny 中配置不同类型的数据库非常简单，只需要完成以上四个步骤的自定义即可。

下操作数据库的逻辑无需修改。

参考:
- drizzle-orm
- supabase

Last updated on 2025年7月3日